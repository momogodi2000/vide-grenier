<!-- templates/components/loading.html -->
{% load static %}

<!-- Loading Component Principal -->
<div id="main-loading" class="fixed inset-0 bg-gradient-to-br from-green-600 via-green-700 to-orange-500 z-[9999] flex items-center justify-center transition-all duration-500">
    <div class="text-center text-white animate-fade-in">
        <!-- Logo animé -->
        <div class="relative mb-8">
            <div class="w-24 h-24 bg-white/10 rounded-3xl backdrop-blur-sm flex items-center justify-center mx-auto mb-4 animate-float shadow-2xl">
                <div class="w-16 h-16 bg-gradient-to-br from-white to-gray-200 rounded-2xl flex items-center justify-center">
                    <span class="text-3xl font-bold text-green-600">V</span>
                </div>
            </div>
            
            <!-- Cercles animés autour du logo -->
            <div class="absolute inset-0 flex items-center justify-center">
                <div class="w-32 h-32 border-2 border-white/30 rounded-full animate-spin-slow"></div>
            </div>
            <div class="absolute inset-0 flex items-center justify-center">
                <div class="w-40 h-40 border border-white/20 rounded-full animate-ping"></div>
            </div>
        </div>
        
        <!-- Titre principal -->
        <h1 class="text-4xl md:text-5xl font-bold mb-4 animate-slide-up">
            Vidé-Grenier <span class="text-orange-300">Kamer</span>
        </h1>
        
        <!-- Barre de progression -->
        <div class="relative w-64 h-2 bg-white/20 rounded-full mx-auto mb-6 overflow-hidden">
            <div id="loading-progress" class="absolute left-0 top-0 h-full bg-gradient-to-r from-white to-orange-300 rounded-full transition-all duration-300 animate-loading-bar"></div>
        </div>
        
        <!-- Messages de chargement -->
        <div id="loading-messages" class="h-6 mb-4">
            <p class="text-lg opacity-90 animate-pulse">Chargement en cours...</p>
        </div>
        
        <!-- Statistiques animées -->
        <div class="grid grid-cols-3 gap-6 mt-8 text-center">
            <div class="animate-count-up">
                <div class="text-2xl font-bold counter" data-target="1250">0</div>
                <div class="text-sm opacity-80">Produits</div>
            </div>
            <div class="animate-count-up" style="animation-delay: 0.2s;">
                <div class="text-2xl font-bold counter" data-target="850">0</div>
                <div class="text-sm opacity-80">Utilisateurs</div>
            </div>
            <div class="animate-count-up" style="animation-delay: 0.4s;">
                <div class="text-2xl font-bold counter" data-target="95">0</div>
                <div class="text-sm opacity-80">% Satisfaction</div>
            </div>
        </div>
        
        <!-- Points de chargement -->
        <div class="flex justify-center space-x-2 mt-8">
            <div class="w-2 h-2 bg-white rounded-full animate-bounce"></div>
            <div class="w-2 h-2 bg-white rounded-full animate-bounce" style="animation-delay: 0.1s;"></div>
            <div class="w-2 h-2 bg-white rounded-full animate-bounce" style="animation-delay: 0.2s;"></div>
        </div>
    </div>
    
    <!-- Particules flottantes -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="absolute top-20 left-10 w-4 h-4 bg-white/20 rounded-full animate-float"></div>
        <div class="absolute top-40 right-20 w-6 h-6 bg-white/10 rounded-full animate-float" style="animation-delay: -1s;"></div>
        <div class="absolute bottom-32 left-1/4 w-3 h-3 bg-white/15 rounded-full animate-float" style="animation-delay: -2s;"></div>
        <div class="absolute bottom-20 right-1/3 w-8 h-8 bg-white/10 rounded-full animate-float" style="animation-delay: -3s;"></div>
        <div class="absolute top-1/2 left-8 w-5 h-5 bg-white/20 rounded-full animate-float" style="animation-delay: -0.5s;"></div>
        <div class="absolute top-1/3 right-8 w-4 h-4 bg-white/15 rounded-full animate-float" style="animation-delay: -1.5s;"></div>
    </div>
</div>

<!-- Loading Skeleton pour les produits -->
<div id="product-skeleton" class="hidden space-y-6">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        {% for i in "12345678"|make_list %}
        <div class="bg-white rounded-2xl overflow-hidden shadow-lg animate-pulse">
            <div class="h-48 bg-gray-300"></div>
            <div class="p-4">
                <div class="h-4 bg-gray-300 rounded mb-2"></div>
                <div class="h-4 bg-gray-300 rounded w-3/4 mb-3"></div>
                <div class="flex justify-between items-center">
                    <div class="h-6 bg-gray-300 rounded w-1/3"></div>
                    <div class="h-4 bg-gray-300 rounded w-1/4"></div>
                </div>
                <div class="h-8 bg-gray-300 rounded mt-4"></div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Loading pour les listes -->
<div id="list-skeleton" class="hidden space-y-4">
    {% for i in "12345"|make_list %}
    <div class="bg-white rounded-lg p-4 shadow animate-pulse">
        <div class="flex space-x-4">
            <div class="w-16 h-16 bg-gray-300 rounded-lg"></div>
            <div class="flex-1 space-y-2">
                <div class="h-4 bg-gray-300 rounded w-3/4"></div>
                <div class="h-4 bg-gray-300 rounded w-1/2"></div>
                <div class="h-3 bg-gray-300 rounded w-1/4"></div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Loading pour les messages de chat -->
<div id="chat-skeleton" class="hidden space-y-4 p-4">
    {% for i in "123"|make_list %}
    <div class="flex space-x-3 animate-pulse">
        <div class="w-8 h-8 bg-gray-300 rounded-full"></div>
        <div class="flex-1">
            <div class="bg-gray-300 rounded-lg p-3 w-3/4">
                <div class="h-3 bg-gray-400 rounded mb-1"></div>
                <div class="h-3 bg-gray-400 rounded w-2/3"></div>
            </div>
            <div class="h-2 bg-gray-300 rounded w-16 mt-1"></div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Loading Spinner Simple -->
<div id="simple-spinner" class="hidden flex items-center justify-center p-8">
    <div class="animate-spin rounded-full h-12 w-12 border-4 border-green-600 border-t-transparent"></div>
</div>

<!-- Loading avec message personnalisé -->
<div id="custom-loading" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center">
    <div class="bg-white rounded-2xl p-8 shadow-2xl text-center max-w-sm mx-4">
        <div class="animate-spin rounded-full h-16 w-16 border-4 border-green-600 border-t-transparent mx-auto mb-4"></div>
        <h3 id="custom-loading-title" class="text-lg font-semibold text-gray-800 mb-2">Chargement...</h3>
        <p id="custom-loading-message" class="text-gray-600">Veuillez patienter</p>
    </div>
</div>

<!-- CSS Animations -->
<style>
@keyframes fade-in {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes slide-up {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    33% { transform: translateY(-10px) rotate(1deg); }
    66% { transform: translateY(-5px) rotate(-1deg); }
}

@keyframes loading-bar {
    0% { width: 0%; }
    25% { width: 25%; }
    50% { width: 60%; }
    75% { width: 85%; }
    100% { width: 100%; }
}

@keyframes count-up {
    from { opacity: 0; transform: scale(0.5); }
    to { opacity: 1; transform: scale(1); }
}

@keyframes spin-slow {
    to { transform: rotate(360deg); }
}

.animate-fade-in { animation: fade-in 1s ease-out; }
.animate-slide-up { animation: slide-up 1s ease-out 0.3s both; }
.animate-float { animation: float 3s ease-in-out infinite; }
.animate-loading-bar { animation: loading-bar 3s ease-in-out infinite; }
.animate-count-up { animation: count-up 0.8s ease-out both; }
.animate-spin-slow { animation: spin-slow 3s linear infinite; }
</style>

<!-- JavaScript pour les animations -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Messages de chargement rotatifs
    const loadingMessages = [
        'Chargement des produits...',
        'Préparation de votre expérience...',
        'Connexion sécurisée...',
        'Finalisation...'
    ];
    
    let messageIndex = 0;
    const messageElement = document.getElementById('loading-messages');
    
    if (messageElement) {
        setInterval(() => {
            messageElement.innerHTML = `<p class="text-lg opacity-90 animate-pulse">${loadingMessages[messageIndex]}</p>`;
            messageIndex = (messageIndex + 1) % loadingMessages.length;
        }, 1500);
    }
    
    // Animation des compteurs
    function animateCounters() {
        const counters = document.querySelectorAll('.counter');
        counters.forEach(counter => {
            const target = parseInt(counter.dataset.target);
            const duration = 2000;
            const increment = target / (duration / 16);
            let current = 0;
            
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                counter.textContent = Math.floor(current);
            }, 16);
        });
    }
    
    // Démarrer les compteurs après un délai
    setTimeout(animateCounters, 1000);
    
    // Masquer le loading après 3 secondes (à adapter selon vos besoins)
    setTimeout(() => {
        const loadingScreen = document.getElementById('main-loading');
        if (loadingScreen) {
            loadingScreen.style.opacity = '0';
            setTimeout(() => {
                loadingScreen.style.display = 'none';
            }, 500);
        }
    }, 3000);
});

// Fonctions utilitaires pour le loading
window.LoadingUtils = {
    show: function(type = 'main') {
        const element = document.getElementById(type + '-loading') || document.getElementById('main-loading');
        if (element) {
            element.classList.remove('hidden');
            element.style.display = 'flex';
        }
    },
    
    hide: function(type = 'main') {
        const element = document.getElementById(type + '-loading') || document.getElementById('main-loading');
        if (element) {
            element.style.opacity = '0';
            setTimeout(() => {
                element.style.display = 'none';
                element.classList.add('hidden');
            }, 300);
        }
    },
    
    showCustom: function(title, message) {
        const customLoading = document.getElementById('custom-loading');
        const titleElement = document.getElementById('custom-loading-title');
        const messageElement = document.getElementById('custom-loading-message');
        
        if (customLoading && titleElement && messageElement) {
            titleElement.textContent = title;
            messageElement.textContent = message;
            customLoading.classList.remove('hidden');
        }
    },
    
    hideCustom: function() {
        const customLoading = document.getElementById('custom-loading');
        if (customLoading) {
            customLoading.classList.add('hidden');
        }
    }
};
</script>