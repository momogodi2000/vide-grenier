{% load static %}

<!-- Footer principal -->
<footer class="bg-gray-900 text-white">
    <!-- Section principale du footer -->
    <div class="container mx-auto px-4 py-12">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
            
            <!-- Colonne 1: À propos de VGK -->
            <div class="space-y-4">
                <div class="flex items-center space-x-2">
                    <div class="w-10 h-10 bg-gradient-to-br from-green-500 to-orange-500 rounded-xl flex items-center justify-center">
                        <span class="text-white font-bold text-xl">V</span>
                    </div>
                    <div>
                        <div class="font-bold text-lg">Vidé-Grenier</div>
                        <div class="font-bold text-orange-400">Kamer</div>
                    </div>
                </div>
                
                <p class="text-gray-300 text-sm leading-relaxed">
                    La première marketplace camerounaise de seconde main. 
                    Vendez, achetez et économisez en toute sécurité à Douala et Yaoundé.
                </p>
                
                <div class="flex space-x-4">
                    <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-green-600 transition-colors">
                        <i data-lucide="facebook" class="w-5 h-5"></i>
                    </a>
                    <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-green-600 transition-colors">
                        <i data-lucide="instagram" class="w-5 h-5"></i>
                    </a>
                    <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-green-600 transition-colors">
                        <i data-lucide="twitter" class="w-5 h-5"></i>
                    </a>
                    <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-green-600 transition-colors">
                        <i data-lucide="youtube" class="w-5 h-5"></i>
                    </a>
                </div>
                
                <!-- Badges de confiance -->
                <div class="space-y-2">
                    <div class="flex items-center space-x-2 text-sm text-gray-400">
                        <i data-lucide="shield-check" class="w-4 h-4 text-green-500"></i>
                        <span>Paiements 100% sécurisés</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-gray-400">
                        <i data-lucide="truck" class="w-4 h-4 text-green-500"></i>
                        <span>Livraison dans toute la ville</span>
                    </div>
                    <div class="flex items-center space-x-2 text-sm text-gray-400">
                        <i data-lucide="headphones" class="w-4 h-4 text-green-500"></i>
                        <span>Support client 24/7</span>
                    </div>
                </div>
            </div>
            
            <!-- Colonne 2: Liens rapides -->
            <div class="space-y-4">
                <h3 class="font-semibold text-lg mb-4">Liens rapides</h3>
                <ul class="space-y-3">
                    <li>
                        <a href="{% url 'backend:home' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="home" class="w-4 h-4"></i>
                            <span>Accueil</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'backend:product_list' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="shopping-bag" class="w-4 h-4"></i>
                            <span>Tous les produits</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'backend:category_list' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="grid-3x3" class="w-4 h-4"></i>
                            <span>Catégories</span>
                        </a>
                    </li>
                    {% if user.is_authenticated %}
                    <li>
                        <a href="{% url 'backend:product_create' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="plus-circle" class="w-4 h-4"></i>
                            <span>Vendre un produit</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'backend:dashboard' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="layout-dashboard" class="w-4 h-4"></i>
                            <span>Mon tableau de bord</span>
                        </a>
                    </li>
                    {% else %}
                    <li>
                        <a href="{% url 'backend:register' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="user-plus" class="w-4 h-4"></i>
                            <span>Créer un compte</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'backend:login' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="log-in" class="w-4 h-4"></i>
                            <span>Se connecter</span>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
            
            <!-- Colonne 3: Support & Aide -->
            <div class="space-y-4">
                <h3 class="font-semibold text-lg mb-4">Support & Aide</h3>
                <ul class="space-y-3">
                    <li>
                        <a href="{% url 'backend:help' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="help-circle" class="w-4 h-4"></i>
                            <span>Centre d'aide</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'backend:contact' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="mail" class="w-4 h-4"></i>
                            <span>Nous contacter</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'backend:terms' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="file-text" class="w-4 h-4"></i>
                            <span>Conditions d'utilisation</span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'backend:privacy' %}" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="shield" class="w-4 h-4"></i>
                            <span>Politique de confidentialité</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="book-open" class="w-4 h-4"></i>
                            <span>Guide vendeur</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="text-gray-300 hover:text-green-400 transition-colors flex items-center space-x-2">
                            <i data-lucide="shield-check" class="w-4 h-4"></i>
                            <span>Sécurité</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <!-- Colonne 4: Contact & Points de retrait -->
            <div class="space-y-4">
                <h3 class="font-semibold text-lg mb-4">Contact</h3>
                
                <div class="space-y-4">
                    <!-- WhatsApp Business -->
                    <div class="bg-gray-800 rounded-lg p-4">
                        <div class="flex items-center space-x-3 mb-2">
                            <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center">
                                <i data-lucide="message-circle" class="w-4 h-4 text-white"></i>
                            </div>
                            <span class="font-semibold">WhatsApp Business</span>
                        </div>
                        <a href="https://wa.me/237694638412" 
                           class="text-green-400 hover:text-green-300 transition-colors text-sm">
                            +237 694 63 84 12
                        </a>
                        <p class="text-gray-400 text-xs mt-1">Support instantané 24/7</p>
                    </div>
                    
                    <!-- Email -->
                    <div class="flex items-center space-x-3 text-sm">
                        <i data-lucide="mail" class="w-4 h-4 text-orange-400"></i>
                        <div>
                            <div class="text-gray-300">support@videgrenier-kamer.com</div>
                            <div class="text-gray-500 text-xs">Réponse sous 2h</div>
                        </div>
                    </div>
                    
                    <!-- Points de retrait -->
                    <div class="space-y-2">
                        <h4 class="font-medium text-sm flex items-center space-x-2">
                            <i data-lucide="map-pin" class="w-4 h-4 text-orange-400"></i>
                            <span>Points de retrait</span>
                        </h4>
                        
                        <div class="text-xs space-y-2">
                            <div class="bg-gray-800 rounded p-2">
                                <div class="font-medium">Douala - Akwa</div>
                                <div class="text-gray-400">123 Ave Ahidjo, face Crédit Lyonnais</div>
                                <div class="text-green-400">Lun-Ven 7h30-18h30</div>
                            </div>
                            
                            <div class="bg-gray-800 rounded p-2">
                                <div class="font-medium">Yaoundé - Centre</div>
                                <div class="text-gray-400">456 Ave Kennedy, près Hilton</div>
                                <div class="text-green-400">Lun-Ven 7h30-18h30</div>
                            </div>
                        </div>
                        
                        <a href="{% url 'backend:pickup_list' %}" 
                           class="inline-flex items-center space-x-1 text-xs text-orange-400 hover:text-orange-300 transition-colors">
                            <span>Voir tous les points</span>
                            <i data-lucide="arrow-right" class="w-3 h-3"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Newsletter -->
    <div class="border-t border-gray-800">
        <div class="container mx-auto px-4 py-8">
            <div class="bg-gradient-to-r from-green-600 to-orange-500 rounded-2xl p-6 md:p-8">
                <div class="grid md:grid-cols-2 gap-6 items-center">
                    <div>
                        <h3 class="text-2xl font-bold text-white mb-2">
                            Restez informé des meilleures affaires !
                        </h3>
                        <p class="text-white/90">
                            Recevez nos dernières offres et nouveautés directement dans votre boîte mail.
                        </p>
                    </div>
                    
                    <div class="space-y-4">
                        <form id="newsletter-form" class="flex space-x-3">
                            <input type="email" 
                                   id="newsletter-email"
                                   placeholder="Votre adresse email" 
                                   class="flex-1 px-4 py-3 rounded-full border-0 focus:ring-2 focus:ring-white/50 outline-none"
                                   required>
                            <button type="submit" 
                                    id="newsletter-submit"
                                    class="bg-white text-green-600 px-6 py-3 rounded-full font-semibold hover:bg-gray-100 transition-colors whitespace-nowrap">
                                S'abonner
                            </button>
                        </form>
                        
                        <div class="flex items-center space-x-2 text-white/80 text-sm">
                            <i data-lucide="shield-check" class="w-4 h-4"></i>
                            <span>Pas de spam, désabonnement facile</span>
                            <span id="newsletter-feedback" class="ml-2 text-green-300"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Application mobile -->
    <div class="border-t border-gray-800">
        <div class="container mx-auto px-4 py-8">
            <div class="text-center space-y-4">
                <h3 class="text-xl font-semibold">Téléchargez notre application</h3>
                <p class="text-gray-400">
                    Accédez à VGK partout, notifications en temps réel, mode hors ligne
                </p>
                
                <div class="flex justify-center space-x-4">
                    <button id="pwa-install-footer" 
                            class="bg-gray-800 hover:bg-gray-700 text-white px-6 py-3 rounded-lg flex items-center space-x-3 transition-colors">
                        <i data-lucide="smartphone" class="w-5 h-5"></i>
                        <div class="text-left">
                            <div class="text-xs text-gray-400">Installer l'app</div>
                            <div class="font-semibold">PWA</div>
                        </div>
                    </button>
                    
                    <a href="#" 
                       class="bg-gray-800 hover:bg-gray-700 text-white px-6 py-3 rounded-lg flex items-center space-x-3 transition-colors">
                        <i data-lucide="play" class="w-5 h-5"></i>
                        <div class="text-left">
                            <div class="text-xs text-gray-400">Bientôt sur</div>
                            <div class="font-semibold">Google Play</div>
                        </div>
                    </a>
                    
                    <a href="#" 
                       class="bg-gray-800 hover:bg-gray-700 text-white px-6 py-3 rounded-lg flex items-center space-x-3 transition-colors">
                        <i data-lucide="smartphone" class="w-5 h-5"></i>
                        <div class="text-left">
                            <div class="text-xs text-gray-400">Bientôt sur</div>
                            <div class="font-semibold">App Store</div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Copyright -->
    <div class="border-t border-gray-800 bg-gray-950">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                <script>
                document.addEventListener('DOMContentLoaded', function() {
                  const form = document.getElementById('newsletter-form');
                  const emailInput = document.getElementById('newsletter-email');
                  const feedback = document.getElementById('newsletter-feedback');
                  form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const email = emailInput.value.trim();
                    feedback.textContent = '';
                    if (!email) {
                      feedback.textContent = 'Veuillez entrer une adresse email.';
                      feedback.classList.remove('text-green-300');
                      feedback.classList.add('text-red-400');
                      return;
                    }
                    fetch('/api/newsletter/subscribe/', {
                      method: 'POST',
                      headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': (document.querySelector('[name=csrfmiddlewaretoken]') || {}).value || ''
                      },
                      body: JSON.stringify({ email })
                    })
                    .then(res => res.json())
                    .then(data => {
                      if (data.success) {
                        feedback.textContent = 'Merci, vous êtes abonné !';
                        feedback.classList.remove('text-red-400');
                        feedback.classList.add('text-green-300');
                        form.reset();
                      } else {
                        feedback.textContent = data.error || 'Erreur, réessayez.';
                        feedback.classList.remove('text-green-300');
                        feedback.classList.add('text-red-400');
                      }
                    })
                    .catch(() => {
                      feedback.textContent = 'Erreur réseau, réessayez.';
                      feedback.classList.remove('text-green-300');
                      feedback.classList.add('text-red-400');
                    });
                  });
                });
                </script>
                <div class="text-gray-400 text-sm">
                    © {{ CURRENT_YEAR }} Vidé-Grenier Kamer. Tous droits réservés.
                    <span class="mx-2">•</span>
                    <span class="text-green-400">🇨🇲 Fièrement camerounais</span>
                </div>
                
                <div class="flex items-center space-x-6 text-sm">
                    <div class="flex items-center space-x-2 text-gray-400">
                        <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                        <span>Tous systèmes opérationnels</span>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <img src="{% static 'images/payments/orange-money.png' %}" 
                             alt="Orange Money" 
                             class="h-6 opacity-70 hover:opacity-100 transition-opacity"
                             onerror="this.style.display='none'">
                        <img src="{% static 'images/payments/mtn-money.png' %}" 
                             alt="MTN Mobile Money" 
                             class="h-6 opacity-70 hover:opacity-100 transition-opacity"
                             onerror="this.style.display='none'">
                        <img src="{% static 'images/payments/campay.png' %}" 
                             alt="Campay" 
                             class="h-6 opacity-70 hover:opacity-100 transition-opacity"
                             onerror="this.style.display='none'">
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- JavaScript pour la newsletter et PWA -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Gestion de la newsletter
    const newsletterForm = document.getElementById('newsletter-form');
    if (newsletterForm) {
        newsletterForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = this.querySelector('input[type="email"]').value;
            const button = this.querySelector('button');
            const originalText = button.textContent;
            
            button.textContent = 'Inscription...';
            button.disabled = true;
            
            try {
                const response = await fetch('/api/newsletter/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': window.VGK.csrf_token
                    },
                    body: JSON.stringify({ email: email })
                });
                
                if (response.ok) {
                    button.textContent = '✓ Inscrit !';
                    button.classList.add('bg-green-500');
                    this.querySelector('input').value = '';
                    
                    if (window.VGK && window.VGK.notifications) {
                        window.VGK.notifications.showToast('Inscription newsletter réussie !', 'success');
                    }
                } else {
                    throw new Error('Erreur d\'inscription');
                }
            } catch (error) {
                button.textContent = originalText;
                if (window.VGK && window.VGK.notifications) {
                    window.VGK.notifications.showToast('Erreur lors de l\'inscription', 'error');
                }
            } finally {
                button.disabled = false;
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('bg-green-500');
                }, 3000);
            }
        });
    }
    
    // Installation PWA depuis le footer
    const pwaInstallFooter = document.getElementById('pwa-install-footer');
    if (pwaInstallFooter) {
        pwaInstallFooter.addEventListener('click', function() {
            if (window.VGK && window.VGK.pwa && window.VGK.pwa.install) {
                window.VGK.pwa.install();
            } else if (window.installPWA) {
                window.installPWA();
            } else {
                if (window.VGK && window.VGK.notifications) {
                    window.VGK.notifications.showToast('Installation PWA non disponible', 'info');
                }
            }
        });
    }
    
    // Animation au scroll pour le footer
    const footer = document.querySelector('footer');
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const footerObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animate-fade-in-up');
            }
        });
    }, observerOptions);
    
    if (footer) {
        footerObserver.observe(footer);
    }
});

// Initialiser les icônes Lucide
if (window.lucide) {
    lucide.createIcons();
}
</script>